{"version":3,"file":"main.44a2c930.js","sources":["../../src/layout/main.vue"],"sourcesContent":["<script setup name=\"Layout\">\r\nimport Header from './components/Header/index.vue'\r\nimport MainSidebar from './components/MainSidebar/index.vue'\r\nimport SubSidebar from './components/SubSidebar/index.vue'\r\nimport Topbar from './components/Topbar/index.vue'\r\nimport Search from './components/Search/index.vue'\r\nimport AppSetting from './components/AppSetting/index.vue'\r\nimport { isExternalLink } from '@/util'\r\n\r\nconst { proxy } = getCurrentInstance()\r\nconst routeInfo = useRoute(), router = useRouter()\r\n\r\nimport useSettingsStore from '@/store/modules/settings'\r\nconst settingsStore = useSettingsStore()\r\nimport useKeepAliveStore from '@/store/modules/keepAlive'\r\nconst keepAliveStore = useKeepAliveStore()\r\nimport useMenuStore from '@/store/modules/menu'\r\nconst menuStore = useMenuStore()\r\n\r\nconst showCopyright = computed(() => {\r\n    return typeof routeInfo.meta.copyright !== 'undefined' ? routeInfo.meta.copyright : settingsStore.copyright.enable\r\n})\r\n\r\nwatch(() => settingsStore.menu.subMenuCollapse, val => {\r\n    if (settingsStore.mode === 'mobile') {\r\n        if (!val) {\r\n            document.querySelector('body').classList.add('hidden')\r\n        } else {\r\n            document.querySelector('body').classList.remove('hidden')\r\n        }\r\n    }\r\n})\r\n\r\nwatch(() => routeInfo.path, () => {\r\n    if (settingsStore.mode === 'mobile') {\r\n        settingsStore.$patch(state => {\r\n            state.menu.subMenuCollapse = true\r\n        })\r\n    }\r\n})\r\n\r\nonMounted(() => {\r\n    proxy.$hotkeys('f5', e => {\r\n        if (settingsStore.topbar.enablePageReload) {\r\n            e.preventDefault()\r\n            reload()\r\n        }\r\n    })\r\n})\r\nprovide('reload', reload)\r\nfunction reload() {\r\n    router.push({\r\n        name: 'reload'\r\n    })\r\n}\r\n\r\nprovide('switchMenu', switchMenu)\r\nfunction switchMenu(index) {\r\n    menuStore.setActived(index)\r\n    if (settingsStore.menu.switchMainMenuAndPageJump) {\r\n        if (isExternalLink(menuStore.sidebarMenusFirstDeepestPath)) {\r\n            window.open(menuStore.sidebarMenusFirstDeepestPath, '_blank')\r\n        } else {\r\n            router.push(menuStore.sidebarMenusFirstDeepestPath)\r\n        }\r\n    }\r\n}\r\n</script>\r\n\r\n<template>\r\n    <div class=\"layout\">\r\n        <div id=\"app-main\">\r\n            <Header />\r\n            <div class=\"wrapper\">\r\n                <div class=\"sidebar-container\" :class=\"{'show': settingsStore.mode === 'mobile' && !settingsStore.menu.subMenuCollapse}\">\r\n                    <MainSidebar />\r\n                    <SubSidebar />\r\n                </div>\r\n                <div class=\"sidebar-mask\" :class=\"{'show': settingsStore.mode === 'mobile' && !settingsStore.menu.subMenuCollapse}\" @click=\"settingsStore.toggleSidebarCollapse()\" />\r\n                <div class=\"main-container\" :style=\"{'padding-bottom': $route.meta.paddingBottom}\">\r\n                    <Topbar v-if=\"!(settingsStore.menu.menuMode === 'head' && !settingsStore.topbar.enableSidebarCollapse && !settingsStore.topbar.enableBreadcrumb)\" />\r\n                    <div class=\"main\">\r\n                        <page-main>\r\n                            <router-view v-slot=\"{ Component, route }\">\r\n                                <transition name=\"main\" mode=\"out-in\" appear>\r\n                                    <keep-alive :include=\"keepAliveStore.list\">\r\n                                        <component :is=\"Component\" :key=\"route.fullPath\" />\r\n                                    </keep-alive>\r\n                                </transition>\r\n                            </router-view>\r\n                        </page-main>\r\n                    </div>\r\n                    <Copyright v-if=\"showCopyright\" />\r\n                </div>\r\n            </div>\r\n            <el-backtop :right=\"20\" :bottom=\"20\" title=\"回到顶部\" />\r\n        </div>\r\n        <Search />\r\n        <AppSetting />\r\n    </div>\r\n</template>\r\n\r\n<style lang=\"scss\" scoped>\r\n[data-mode=\"mobile\"] {\r\n    .sidebar-container {\r\n        transform: translateX(calc((var(--g-main-sidebar-width) + var(--g-sub-sidebar-width)) * -1));\r\n        &.show {\r\n            transform: translateX(0);\r\n        }\r\n    }\r\n    .main-container {\r\n        margin-left: 0 !important;\r\n    }\r\n    &[data-menu-mode=\"single\"] {\r\n        .sidebar-container {\r\n            transform: translateX(calc(var(--g-sub-sidebar-width) * -1));\r\n            &.show {\r\n                transform: translateX(0);\r\n            }\r\n        }\r\n    }\r\n}\r\n.layout {\r\n    height: 100%;\r\n}\r\n#app-main {\r\n    width: 100%;\r\n    height: 100%;\r\n    margin: 0 auto;\r\n    transition: all 0.2s;\r\n}\r\n.wrapper {\r\n    position: relative;\r\n    width: 100%;\r\n    height: 100%;\r\n    box-shadow: -1px 0 0 0 var(--g-box-shadow-color);\r\n    transition: padding-top 0.3s;\r\n    .sidebar-container {\r\n        position: fixed;\r\n        z-index: 1010;\r\n        top: 0;\r\n        bottom: 0;\r\n        display: flex;\r\n        transition: transform 0.3s, top 0.3s;\r\n        width: calc(var(--g-main-sidebar-actual-width) + var(--g-sub-sidebar-actual-width));\r\n    }\r\n    .sidebar-mask {\r\n        position: fixed;\r\n        z-index: 1000;\r\n        top: 0;\r\n        left: 0;\r\n        width: 100%;\r\n        height: 100%;\r\n        background-color: rgb(0 0 0 / 50%);\r\n        backdrop-filter: blur(2px);\r\n        transition: all 0.2s;\r\n        transform: translateZ(0);\r\n        opacity: 0;\r\n        visibility: hidden;\r\n        &.show {\r\n            opacity: 1;\r\n            visibility: visible;\r\n        }\r\n    }\r\n    .main-sidebar-container:not(.main-sidebar-leave-active) + .sub-sidebar-container {\r\n        left: var(--g-main-sidebar-width);\r\n    }\r\n    .main-container {\r\n        display: flex;\r\n        flex-direction: column;\r\n        min-height: 100%;\r\n        margin-left: calc(var(--g-main-sidebar-actual-width) + var(--g-sub-sidebar-actual-width));\r\n        background-color: var(--g-main-bg);\r\n        transition: margin-left 0.3s, background-color 0.3s;\r\n        .topbar-container {\r\n            top: 0;\r\n            z-index: 998;\r\n        }\r\n        .main {\r\n            height: 100%;\r\n            flex: auto;\r\n            position: relative;\r\n            overflow: hidden;\r\n            transition: 0.3s;\r\n        }\r\n        .topbar-container + .main {\r\n            margin: var(--g-topbar-height) 0 0;\r\n        }\r\n    }\r\n}\r\nheader:not(.header-leave-active) + .wrapper {\r\n    padding-top: var(--g-header-height);\r\n    .sidebar-container {\r\n        top: var(--g-header-height);\r\n        :deep(.sidebar-logo) {\r\n            display: none;\r\n        }\r\n        :deep(.el-menu) {\r\n            padding-top: 0;\r\n        }\r\n    }\r\n    .main-container {\r\n        .topbar-container {\r\n            top: var(--g-header-height);\r\n            :deep(.tools) {\r\n                display: none;\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\n// 主内容区动画\r\n.main-enter-active {\r\n    transition: 0.2s;\r\n}\r\n.main-leave-active {\r\n    transition: 0.15s;\r\n}\r\n.main-enter-from {\r\n    opacity: 0;\r\n    margin-left: -20px;\r\n}\r\n.main-leave-to {\r\n    opacity: 0;\r\n    margin-left: 20px;\r\n}\r\n</style>\r\n"],"names":["proxy","getCurrentInstance","routeInfo","useRoute","router","useRouter","settingsStore","useSettingsStore","keepAliveStore","useKeepAliveStore","menuStore","useMenuStore","showCopyright","computed","meta","copyright","enable","reload","push","name","watch","menu","subMenuCollapse","val","mode","document","querySelector","classList","remove","add","path","$patch","state","onMounted","$hotkeys","e","topbar","enablePageReload","preventDefault","provide","index","setActived","switchMainMenuAndPageJump","isExternalLink","sidebarMenusFirstDeepestPath","window","open"],"mappings":"itCASA,MAAAA,MAAAA,GAAAC,IACAC,EAAAC,IAAAC,EAAAC,IAGAC,EAAAC,IAEAC,EAAAC,IAEAC,EAAAC,IAEAC,EAAAC,GAAA,SACA,IAAAX,EAAAY,KAAAC,UAAAb,EAAAY,KAAAC,UAAAT,EAAAS,UAAAC,SA8BA,SAAAC,IACAb,EAAAc,KAAA,CACAC,KAAA,kBA7BAC,GAAA,IAAAd,EAAAe,KAAAC,kBAAAC,IACA,WAAAjB,EAAAkB,OACAD,EAGAE,SAAAC,cAAA,QAAAC,UAAAC,OAAA,UAFAH,SAAAC,cAAA,QAAAC,UAAAE,IAAA,cAOAT,GAAA,IAAAlB,EAAA4B,OAAA,KACA,WAAAxB,EAAAkB,MACAlB,EAAAyB,QAAAC,IACAA,EAAAX,KAAAC,iBAAA,QAKAW,GAAA,KACAjC,EAAAkC,SAAA,MAAAC,IACA7B,EAAA8B,OAAAC,mBACAF,EAAAG,iBACArB,WAIAsB,EAAA,SAAAtB,GAOAsB,EAAA,cACA,SAAAC,GACA9B,EAAA+B,WAAAD,GACAlC,EAAAe,KAAAqB,4BACAC,EAAAjC,EAAAkC,8BACAC,OAAAC,KAAApC,EAAAkC,6BAAA,UAEAxC,EAAAc,KAAAR,EAAAkC"}